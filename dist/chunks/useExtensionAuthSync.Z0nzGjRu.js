const n={AUTH_TOKEN_SYNC:"UNCHONK_AUTH_SYNC",AUTH_TOKEN_CLEAR:"UNCHONK_AUTH_CLEAR",REQUEST_AUTH_TOKEN:"UNCHONK_REQUEST_AUTH",AUTH_SYNC_ACK:"UNCHONK_AUTH_ACK"},o="unchonk-extension";function _(){const t=async i=>{if(i.origin!==window.location.origin)return;const e=i.data;e?.extensionId===o&&(e.type===n.AUTH_TOKEN_SYNC&&e.authToken&&(localStorage.setItem("auth_token",e.authToken),e.refreshToken&&localStorage.setItem("refresh_token",e.refreshToken),window.postMessage({type:n.AUTH_SYNC_ACK,extensionId:o,timestamp:Date.now()},window.location.origin)),e.type===n.AUTH_TOKEN_CLEAR&&(localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token")))};return window.addEventListener("message",t),window.postMessage({type:n.REQUEST_AUTH_TOKEN,extensionId:o},window.location.origin),()=>{window.removeEventListener("message",t)}}export{_ as i};
